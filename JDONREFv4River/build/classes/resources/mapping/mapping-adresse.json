{
     "adresse": {
        "_type": {"store": true},
        "_source": {"excludes": ["geometrie"]},
        "properties" : {
            "adr_id" : { "type" : "string", "index":"no"},
            "voi_id" : { "type" : "string", "index":"no"},
            "article" : { "type" : "string", "index":"no"},
            "libelle" : { "type" : "string", "analyzer":"jdonrefv4_index_token_count","search_analyzer":"jdonrefv4_search"},
            "type_de_voie" : { "type" : "string", "analyzer":"jdonrefv4_index_token_count","search_analyzer":"jdonrefv4_search"},
            "code_pays" : { "type" : "string", "index":"no"},
            "pays" : { "type" : "string" , "index": "no"},
            "code_insee" : { "type" : "string", "index":"not_analyzed", "copy_to": ["codes"]},
            "code_insee_commune" : { "type" : "string", "index":"not_analyzed", "copy_to": ["codes"]},
            "code_arrondissement" : { "type" : "string", "index":"not_analyzed", "copy_to": ["codes"]},
            "code_postal" : { "type" : "string", "index":"not_analyzed", "copy_to": ["codes"]},
            "code_departement" : { "type" : "string", "index":"not_analyzed", "copy_to": ["codes"]},
            "codes" : { "type" : "string",  "analyzer":"jdonrefv4_codes_index","search_analyzer":"jdonrefv4_search"},
            "commune" : { "type" : "string" , "analyzer":"jdonrefv4_index","search_analyzer":"jdonrefv4_search"},
            "numero" : { "type" : "string", "analyzer":"jdonrefv4_index_token_count","search_analyzer":"jdonrefv4_search"},
            "repetition" : { "type" : "string", "analyzer":"jdonrefv4_index_token_count","search_analyzer":"jdonrefv4_search"},
            "pin" : { "properties" : { "centroide" : { "type" : "geo_point" , "fielddata" : { "format" : "compressed" , "precision" : "1cm"}}}},
            "geometrie" : { "type" : "geo_shape", "precision": "1cm", "tree": "quadtree"},
            "score" : { "type" : "string", "term_vector": "yes","index":"analyzed" , "analyzer":"jdonrefv4_score_analyzer"}
        },
        "transform": {
          "lang" : "groovy",
          "script" : "ctx._source['score']= ''; if (ctx._source['numero']!=null) { def tokens= ctx._source['numero'].split(' '); for(x in tokens) ctx._source['numero'] += ' ' + x + '|1'; }; if (ctx._source['repetition']!=null) { def tokens= ctx._source['repetition'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|2'; }; if (ctx._source['type_de_voie']!=null) { def tokens= ctx._source['type_de_voie'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|3'; }; if (ctx._source['libelle']!=null) { def tokens= ctx._source['libelle'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|4'; }; if (ctx._source['code_postal']!=null) { def tokens= ctx._source['code_postal'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|5'; }; if (ctx._source['code_departement']!=null) { def tokens= ctx._source['code_departement'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|6'; }; if (ctx._source['code_arrondissement']!=null) { def tokens= ctx._source['code_arrondissement'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|7'; }; if (ctx._source['code_insee']!=null) { def tokens= ctx._source['code_insee'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|8'; }; if (ctx._source['code_insee_commune']!=null) { def tokens= ctx._source['code_insee_commune'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|9'; }; if (ctx._source['commune']!=null) { def tokens= ctx._source['commune'].split(' '); for(x in tokens) ctx._source['score'] += ' ' + x + '|10'; }; "
        }
    }
}